<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Простий чат</title>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #eee; padding: 20px; }
    #chat { height: 300px; overflow-y: auto; border: 1px solid #555; padding: 10px; margin-bottom: 10px; background: #222; }
    .message { margin-bottom: 8px; }
    .user { color: #8ecae6; font-weight: bold; }
    input, button { padding: 10px; font-size: 16px; }
    input { width: 70%; }
    button { width: 25%; background: #444; color: white; border: none; cursor: pointer; }
    button:hover { background: #666; }
  </style>

  <!-- Firebase SDK (версія compat для простоти) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>

<h1>Чат з подругою</h1>

<div id="chat"></div>

<input type="text" id="username" placeholder="Твоє ім'я" />
<br><br>
<input type="text" id="messageInput" placeholder="Напиши повідомлення..." />
<button id="sendBtn">Відправити</button>

<script>
  // Твоя Firebase конфігурація
  const firebaseConfig = {
    apiKey: "AIzaSyBEEfn7xzGqKa1Cq9KOeeDXv836wMreFrA",
    authDomain: "scary-72f98.firebaseapp.com",
    databaseURL: "https://scary-72f98-default-rtdb.firebaseio.com",
    projectId: "scary-72f98",
    storageBucket: "scary-72f98.appspot.com",
    messagingSenderId: "450754639280",
    appId: "1:450754639280:web:5550f2cfeb4aac1f0e1275",
    measurementId: "G-6FKRD4WWHG"
  };

  // Ініціалізуємо Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const chat = document.getElementById('chat');
  const usernameInput = document.getElementById('username');
  const messageInput = document.getElementById('messageInput');
  const sendBtn = document.getElementById('sendBtn');

  // Відправка повідомлення у базу
  sendBtn.onclick = () => {
    const username = usernameInput.value.trim() || "Анонім";
    const message = messageInput.value.trim();
    if (!message) return;

    // Створюємо нове повідомлення у базі
    const newMsgKey = db.ref().child('messages').push().key;

    db.ref('messages/' + newMsgKey).set({
      user: username,
      text: message,
      timestamp: Date.now()
    });

    messageInput.value = '';
  };

  // Відображення повідомлень з бази у реальному часі
  db.ref('messages').on('value', snapshot => {
    chat.innerHTML = '';
    const messages = snapshot.val();
    if (!messages) return;

    // Сортуємо по часу (timestamp)
    const sortedMessages = Object.values(messages).sort((a, b) => a.timestamp - b.timestamp);

    sortedMessages.forEach(msg => {
      const div = document.createElement('div');
      div.classList.add('message');
      div.innerHTML = `<span class="user">${msg.user}:</span> ${msg.text}`;
      chat.appendChild(div);
    });

    chat.scrollTop = chat.scrollHeight;
  });
</script>

</body>
</html>
